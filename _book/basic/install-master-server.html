
<!DOCTYPE HTML>
<html lang="zh-tw" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>安裝 Master Server · Puppet 管理者指南</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-page-toc-button/plugin.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="install-puppet-agent.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="輸入並搜尋" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../intro/">
            
                <a href="../intro/">
            
                    
                    前言
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../intro/what-is-puppet.html">
            
                <a href="../intro/what-is-puppet.html">
            
                    
                    什麼是 Puppet
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../intro/why-use-puppet.html">
            
                <a href="../intro/why-use-puppet.html">
            
                    
                    為什麼要用 Puppet
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="./">
            
                <a href="./">
            
                    
                    基礎概念
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.3.1" data-path="install-master-server.html">
            
                <a href="install-master-server.html">
            
                    
                    安裝 Master Server
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="install-puppet-agent.html">
            
                <a href="install-puppet-agent.html">
            
                    
                    安裝 Puppet Agent 
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="how-to-master-and-agent-auth.html">
            
                <a href="how-to-master-and-agent-auth.html">
            
                    
                    Master 和 Agent 的認證關係
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.3.1" data-path="auth/how-to-policy-based-autoscaling.html">
            
                <a href="auth/how-to-policy-based-autoscaling.html">
            
                    
                    實作 policy-based autosigning
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="how-to-write-manifests.html">
            
                <a href="how-to-write-manifests.html">
            
                    
                    第一個 manifests 設定
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="how-to-write-module.html">
            
                <a href="how-to-write-module.html">
            
                    
                    第一個 module 設定
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6" data-path="how-to-use-resource-older.html">
            
                <a href="how-to-use-resource-older.html">
            
                    
                    處理 resource 的先後順序
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.7" data-path="how-to-use-hiera-data.html">
            
                <a href="how-to-use-hiera-data.html">
            
                    
                    怎麼使用 Hiera data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../advanced/">
            
                <a href="../advanced/">
            
                    
                    進階管理
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../advanced/role-and-profile-pattern.html">
            
                <a href="../advanced/role-and-profile-pattern.html">
            
                    
                    Role and Profile pattern 的管理方式
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../advanced/how-to-encrypt-hiera-data.html">
            
                <a href="../advanced/how-to-encrypt-hiera-data.html">
            
                    
                    怎麼加密 Hiera data
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../advanced/how-to-use-puppet-from-git.html">
            
                <a href="../advanced/how-to-use-puppet-from-git.html">
            
                    
                    讓 Puppet 進 git 版控
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../advanced/backup-and-restore.html">
            
                <a href="../advanced/backup-and-restore.html">
            
                    
                    備份與還原
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../workshop/">
            
                <a href="../workshop/">
            
                    
                    WorkShop
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../workshop/build-linux-base.html">
            
                <a href="../workshop/build-linux-base.html">
            
                    
                    實作 Linux 基礎環境設定
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../workshop/build-lamp.html">
            
                <a href="../workshop/build-lamp.html">
            
                    
                    實作 LAMP
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../workshop/build-nginx-and-nodejs.html">
            
                <a href="../workshop/build-nginx-and-nodejs.html">
            
                    
                    實作 Nginx 和 Nodejs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../test/">
            
                <a href="../test/">
            
                    
                    測試
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../deploy/">
            
                <a href="../deploy/">
            
                    
                    佈署到其他平台
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.2.1" data-path="../deploy/how-to-build-docker.container.html">
            
                <a href="../deploy/how-to-build-docker.container.html">
            
                    
                    佈署到 Docker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2.2" data-path="../deploy/how-to-build-docker.container.html">
            
                <a href="../deploy/how-to-build-docker.container.html">
            
                    
                    佈署到 AWS AMI
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            本書使用 GitBook 釋出
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >安裝 Master Server</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="&#x5B89;&#x88DD;-master-server">&#x5B89;&#x88DD; Master Server</h1>
<h2 id="&#x74B0;&#x5883;">&#x74B0;&#x5883;</h2>
<p>&#x5148;&#x5B9A;&#x7FA9;&#x597D; Puppet master &#x548C; agent &#x7684;&#x74B0;&#x5883;&#xFF1A;</p>
<ul>
<li><p>Operating system: Ubuntu 16.04</p>
</li>
<li><p>Master</p>
<ul>
<li><p>IP Address: 192.168.10.10</p>
</li>
<li><p>Domain : master.puppet.com</p>
</li>
</ul>
</li>
<li><p>Agent</p>
<ul>
<li><p>IP Address: 192.168.10.11</p>
</li>
<li><p>Domain : agent.puppet.com</p>
</li>
</ul>
</li>
</ul>
<h2 id="&#x5B89;&#x88DD;">&#x5B89;&#x88DD;</h2>
<ol>
<li><p>Puppet &#x91DD;&#x5C0D;&#x6240;&#x6709;&#x7684;&#x4E3B;&#x6A5F;&#x7686;&#x9808;&#x5B9A;&#x7FA9;&#x70BA; Domain&#x3002;</p>
<p>&#x5728; Puppet &#x5B98;&#x65B9;&#x6709;&#x63D0;&#x5230;&#xFF1A;</p>
<blockquote>
<p>Name resolution: Every node must have a unique hostname. Forward and reverse DNS must both be configured correctly. (Instructions for configuring DNS are beyond the scope of this guide. If your site lacks DNS, you must write an /etc/hosts file on each node.)</p>
<p>Note: The default Puppet master hostname is puppet. Your agent nodes can be ready sooner if this hostname resolves to your Puppet master.</p>
</blockquote>
<p>&#x5982;&#x679C;&#x4F60;&#x9084;&#x6C92;&#x6709;&#x5B9A;&#x7FA9;&#x597D; Puppet Master / Agent &#x7684; Domain&#xFF0C;&#x53EF;&#x4EE5;&#x5148;&#x8A2D;&#x5B9A;&#x5728; hosts&#x3002;</p>
<pre><code class="lang-shell">$ cat /etc/hosts
192.168.10.10 master.puppet.com
192.168.10.11 agent.puppet.com
</code></pre>
</li>
<li><p>Puppet Master &#x5FC5;&#x9808;&#x6E96;&#x78BA;&#x6821;&#x6642;&#x3002;</p>
<pre><code class="lang-shell">$ sudo ntpdate time.stdtime.gov.tw
$ sudo timedatectl set-timezone Asia/Taipei
</code></pre>
</li>
<li><p>&#x5B89;&#x88DD; Puppet Master</p>
<p>&#x5F9E;&#x5B98;&#x65B9; <a href="https://docs.puppet.com/puppet/5.1/puppet_platform.html" target="_blank">repository</a> &#x53D6;&#x5F97; Puppet package&#x3002;</p>
<pre><code class="lang-shell">$ wget https://apt.puppetlabs.com/puppet5-release-xenial.deb
$ sudo dpkg -i puppet5-release-xenial.deb
$ sudo apt-get update
$ sudo apt-get install puppetserver
</code></pre>
</li>
<li><p>Puppet master Memory &#x8ABF;&#x6574;&#xFF0C;&#x9810;&#x8A2D;&#x70BA; 2G</p>
<pre><code class="lang-shell">$ sudo vim /etc/default/puppetserver
JAVA_ARGS=&quot;-Xms2g -Xmx2g&quot;
</code></pre>
</li>
<li><p>&#x4FEE;&#x6539; Puppet &#x7684;&#x4E3B;&#x8981;&#x8A2D;&#x5B9A;&#x6A94; <a href="https://docs.puppet.com/puppet/5.0/configuration.html" target="_blank">puppet.conf</a></p>
<pre><code class="lang-shell">sudo vim /etc/puppetlabs/puppet/puppet.conf

[main]
 certname = master.puppet.com
</code></pre>
<p>certname &#x662F;&#x7528;&#x4F86;&#x751F;&#x6210;&#x9019;&#x53F0; node &#x6191;&#x8B49;&#x4F7F;&#x7528;&#xFF0C;Puppet &#x4E4B;&#x9593;&#x7684;&#x6E9D;&#x901A;&#x662F;&#x4F7F;&#x7528; SSL &#x4EA4;&#x63E1;&#x3002;</p>
</li>
</ol>
<ol>
<li><p>&#x5617;&#x8A66;&#x555F;&#x52D5; Puppet master</p>
<pre><code class="lang-shell">$ sudo service puppetserver start
$ sudo systemctl enable puppetserver
</code></pre>
</li>
<li><p>&#x61C9;&#x8A72;&#x8981; listen 8140 port&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x662F;&#x7531; Java &#x555F;&#x52D5;&#xFF0C;&#x56E0;&#x70BA; Puppet master &#x662F;&#x7528; Java &#x958B;&#x767C;&#x3002;</p>
<pre><code class="lang-shell">$ ss -tunlp | grep 8140
tcp  LISTEN  0  50  :::8140  :::*  users  ((&quot;java&quot;,pid=27866,fd=32))
</code></pre>
</li>
<li><p>&#x521D;&#x59CB;&#x5316; Puppet server &#x7684; ca &#x6191;&#x8B49;&#xFF0C;&#x5982;&#x679C;&#x6C92;&#x6709;&#x57F7;&#x884C; Agent &#x6703;&#x7121;&#x6CD5;&#x900F;&#x904E; ca &#x4F86;&#x7522;&#x751F; Agent &#x7684; certname&#x3002;</p>
<pre><code class="lang-shell">$ sudo puppet cert list
</code></pre>
</li>
<li><p>&#x5982;&#x679C;&#x4F60;&#x6709;&#x958B;&#x555F; Firewall &#x8A18;&#x5F97; allow 8140</p>
<pre><code class="lang-shell">$ sudo ufw allow 8140
</code></pre>
</li>
</ol>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: 基礎概念">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="install-puppet-agent.html" class="navigation navigation-next " aria-label="Next page: 安裝 Puppet Agent ">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"安裝 Master Server","level":"1.3.1","depth":2,"next":{"title":"安裝 Puppet Agent ","level":"1.3.2","depth":2,"path":"basic/install-puppet-agent.md","ref":"basic/install-puppet-agent.md","articles":[]},"previous":{"title":"基礎概念","level":"1.3","depth":1,"path":"basic/README.md","ref":"basic/README.md","articles":[{"title":"安裝 Master Server","level":"1.3.1","depth":2,"path":"basic/install-master-server.md","ref":"basic/install-master-server.md","articles":[]},{"title":"安裝 Puppet Agent ","level":"1.3.2","depth":2,"path":"basic/install-puppet-agent.md","ref":"basic/install-puppet-agent.md","articles":[]},{"title":"Master 和 Agent 的認證關係","level":"1.3.3","depth":2,"path":"basic/how-to-master-and-agent-auth.md","ref":"basic/how-to-master-and-agent-auth.md","articles":[{"title":"實作 policy-based autosigning","level":"1.3.3.1","depth":3,"path":"basic/auth/how-to-policy-based-autoscaling.md","ref":"basic/auth/how-to-policy-based-autoscaling.md","articles":[]}]},{"title":"第一個 manifests 設定","level":"1.3.4","depth":2,"path":"basic/how-to-write-manifests.md","ref":"basic/how-to-write-manifests.md","articles":[]},{"title":"第一個 module 設定","level":"1.3.5","depth":2,"path":"basic/how-to-write-module.md","ref":"basic/how-to-write-module.md","articles":[]},{"title":"處理 resource 的先後順序","level":"1.3.6","depth":2,"path":"basic/how-to-use-resource-older.md","ref":"basic/how-to-use-resource-older.md","articles":[]},{"title":"怎麼使用 Hiera data","level":"1.3.7","depth":2,"path":"basic/how-to-use-hiera-data.md","ref":"basic/how-to-use-hiera-data.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["ga","github","page-toc-button","livereload"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"github":{"url":"https://github.com/shazi7804/puppet-manage-guide"},"livereload":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"theme":"white","family":"sans","size":2},"highlight":{},"page-toc-button":{"maxTocDepth":2,"minTocSize":2},"ga":{"configuration":"auto","token":"UA-50267306-2"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"Puppet 管理者指南","language":"zh-tw","gitbook":"*","description":"提供給想要入手 Puppet 的管理者，帶你進入 Puppet 的自動化世界。"},"file":{"path":"basic/install-master-server.md","mtime":"2017-08-31T11:59:24.000Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-10-18T06:53:32.159Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-page-toc-button/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-livereload/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

